/* === Vars & Reset === */
:root{
  --bg:#fafafa;
  --card:#fff;
  --border:#ccc;
  --border-strong:#666;
  --muted:#666;
  --accent:#2d89ef;

  /* feste Spaltenbreiten – kompakt, aber 3-stellig sicher */
  --col-desc:   96px;  /* reicht für „ZwTotalUnten“, „Reihentotal“ */
  --col-score:  44px;  /* 3-stellige Zahlen passen */
  --table-radius: 10px;
}

*{ box-sizing:border-box; }
html,body{ margin:0; padding:0; background:var(--bg); color:#222; }
body{ font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }
h2{ margin:.5rem 0; }

/* === Buttons === */
button{
  cursor:pointer; font-size:1rem; padding:.4rem .6rem;
  border-radius:6px; border:1px solid var(--border); background:#f8f8f8;
}
button:hover{ background:#eee; }
button.small{ font-size:.85rem; padding:.25rem .5rem; }

/* === Chips & Badges === */
.chip{ display:inline-block; padding:.1rem .5rem; border-radius:12px; font-size:.8rem; margin-right:.25rem; }
.chip.ok{ background:#c8f7c5; color:#145214; }
.chip.wait{ background:#f9e79f; color:#6a4a00; }
.chip.warn{ background:#f5b7b1; color:#922b21; }
.chip.info{ background:#d6eaf8; color:#154360; }

.badge{ display:inline-block; background:#eee; padding:.1rem .45rem; border-radius:8px; font-size:.8rem; margin-left:.25rem; }

/* === Layout === */
.topbar{ display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap; margin-bottom:.5rem; }

/* fix: nicht auf volle Breite strecken */
.players-inline{ flex:0 0 auto; }

.muted{ color:var(--muted); font-size:.86rem; margin:.25rem 0 .75rem; }

.players-grid{
  display:flex;
  flex-wrap:wrap;
  gap:1rem;
  justify-content:flex-start;   /* statt verteilen */
  align-items:flex-start;
}

/* Card mit runden Ecken (Breite aus Spalten abgeleitet) */
.player-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: .6rem;
  flex: 0 0 auto;
  width: calc(var(--col-desc) + 4 * var(--col-score) + 22px);
  flex: 0 0 calc(var(--col-desc) + 4 * var(--col-score) + 22px); /* fixbreit */
  box-shadow: 0 2px 6px rgba(0,0,0,.06);
}
.player-card.turn{ border-color:#2b8cff; box-shadow:0 0 0 2px rgba(43,140,255,.12); }
.pc-head{ display:flex; align-items:baseline; justify-content:space-between; gap:.75rem; font-weight:700; margin-bottom:.5rem; }
.pc-total{ font-weight:700; }

/* === Dice === */
#diceBar{ display:flex; gap:.35rem; align-items:center; }
button.die{
  font-size:2rem; width:2.6rem; height:2.6rem; border-radius:.6rem;
  font-variant-numeric: tabular-nums;
  display:inline-flex; align-items:center; justify-content:center; /* leer/zentriert */
  background:#fff; color:#000; border:1px solid var(--border);
}
button.die.held{ background:#d4efdf; border-color:#27ae60; }

/* === Announce & Banner === */
.announce-slot{ margin:.5rem 0; }
.announce-box{ background:#f4f6f7; border:1px solid var(--border); padding:.45rem; border-radius:6px; }
.announce-box label{ margin-right:.35rem; }

.banner.correction{
  background:#ffeaa7; border:1px solid #f39c12;
  padding:.55rem; margin-bottom:.6rem; border-radius:6px; font-size:.9rem;
}

/* === Table (fixe Breite, linksbündig, runde Ecken) === */
.table-wrap{ border-radius:var(--table-radius); overflow:hidden; }
table.grid{
  border-collapse:separate; border-spacing:0;
  font-size:.9rem; table-layout:fixed;
  border-radius:var(--table-radius); overflow:hidden;
  width: calc(var(--col-desc) + 4 * var(--col-score));
  margin: 0; /* linksbündig */
  font-variant-numeric: tabular-nums;
}

/* feste Spaltenbreiten */
table.grid th:nth-child(1), table.grid td:nth-child(1){ width:var(--col-desc); text-align:left; }
table.grid th:nth-child(2), table.grid td:nth-child(2),
table.grid th:nth-child(3), table.grid td:nth-child(3),
table.grid th:nth-child(4), table.grid td:nth-child(4),
table.grid th:nth-child(5), table.grid td:nth-child(5){ width:var(--col-score); text-align:center; }

table.grid th, table.grid td{
  border:1px solid var(--border);
  padding:.28rem .35rem;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
table.grid thead th{ background:#f7f7f7; font-weight:700; }

table.grid th.sticky,
table.grid td.desc.sticky{ position:sticky; left:0; background:#f0f0f0; text-align:left; z-index:1; }

/* Klickzustände */
td.cell.clickable{ cursor:pointer; background:#fdfdfd; }
td.cell.clickable:hover{ background:#eef; }
td.cell.announced{ background:#ffe9e9 !important; font-weight:700; }

/* Compute-Felder (grau) */
td.cell.compute, td.desc.compute{ background:#f2f3f5; color:#444; font-weight:600; }
td.cell.compute{ font-size:.86rem; }

/* === Blockrahmen NUR horizontal (keine vertikale Dicke zwischen Spalten) === */
tr.grp-top td{ border-top:3px solid var(--border-strong); }
tr.grp-top.grp-end td{ border-bottom:3px solid var(--border-strong); }

tr.grp-diff td{ border-top:3px solid var(--border-strong); border-bottom:3px solid var(--border-strong); }

tr.grp-bottom.grp-start td{ border-top:3px solid var(--border-strong); }
tr.grp-bottom td{ border-bottom:3px solid var(--border-strong); }

tr.grp-top td, tr.grp-bottom td, tr.grp-diff td{
  border-left:1px solid var(--border) !important;
  border-right:1px solid var(--border) !important;
}

/* --- sehr schmale Screens --- */
@media (max-width:420px){
  :root{
    --col-desc: 90px;
    --col-score: 40px;
  }
  .player-card{ width: calc(var(--col-desc) + 4 * var(--col-score) + 22px); flex-basis: calc(var(--col-desc) + 4 * var(--col-score) + 22px);}
}

/* === Leaderboard Styles === */
.leaderboards {
  display: flex;
  gap: 20px;
  margin-top: 10px;
  flex-wrap: wrap;
  justify-content: flex-start; /* fix */
}

.leaderboard-box {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--table-radius);
  padding: 0.5rem;
  box-shadow: 0 2px 6px rgba(0,0,0,.06);
  min-width: 320px;
  flex: 0 0 520px;    /* fixbreit */
  max-width: 520px;
}

.leaderboard-box h3 {
  margin: 0.3rem 0 0.6rem;
  text-align: center;
  font-weight: 600;
  color: #333;
}

.leaderboard-box table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: .9rem;
  font-variant-numeric: tabular-nums;
  border-radius: var(--table-radius);
  overflow: hidden;
}

.leaderboard-box th,
.leaderboard-box td {
  border: 1px solid var(--border);
  padding: .3rem .4rem;
  text-align: center;
}

.leaderboard-box thead th {
  background: #f7f7f7;
  font-weight: 700;
}

.leaderboard-box thead th:first-child { border-top-left-radius: var(--table-radius); }
.leaderboard-box thead th:last-child { border-top-right-radius: var(--table-radius); }
.leaderboard-box tbody tr:last-child td:first-child { border-bottom-left-radius: var(--table-radius); }
.leaderboard-box tbody tr:last-child td:last-child { border-bottom-right-radius: var(--table-radius); }

/* --- Chips/Bubbles sauber anordnen --- */
#playerChips,
#roomStatusLine,
.top-chips,
.chips,
.players-inline {
  display: inline-flex;      /* statt block-level flex */
  flex-wrap: wrap;
  align-items: center;
  gap: .45rem .55rem;
  width: auto;               /* Container nur so breit wie Inhalt */
  max-width: 100%;           /* falls nötig, bricht es trotzdem um */
}

.badge, .chip { white-space: nowrap; }

.announce-slot {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: .5rem;
}